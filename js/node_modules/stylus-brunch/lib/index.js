(function() {
  var StylusCompiler, nib, stylus, sysPath;

  nib = require('nib');

  stylus = require('stylus');

  sysPath = require('path');

  module.exports = StylusCompiler = (function() {

    StylusCompiler.prototype.brunchPlugin = true;

    StylusCompiler.prototype.type = 'stylesheet';

    StylusCompiler.prototype.extension = 'styl';

    StylusCompiler.prototype.generators = {
      backbone: {
        style: '@import "nib"\n'
      }
    };

    function StylusCompiler(config) {
      this.config = config;
      null;
    }

    StylusCompiler.prototype.compile = function(data, path, callback) {
      var _ref;
      return stylus(data).set('compress', true).set('firebug', !!((_ref = this.config.stylus) != null ? _ref.firebug : void 0)).include(sysPath.join(this.config.rootPath)).include(sysPath.dirname(path)).use(nib()).render(callback);
    };

    return StylusCompiler;

  })();

}).call(this);
